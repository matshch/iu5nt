\documentclass[russian,utf8,a2paper,simple,nocolumnxxvi,vpadding=0mm]{eskdgraph}
\usepackage{cmap}
\usepackage{tikz}
\usetikzlibrary{shapes.misc,shapes.geometric,shapes.multipart,calc,positioning}

\newcommand{\No}{\textnumero}

\ESKDdepartment{МГТУ им. Н.Э.\,Баумана}
\ESKDcompany{Кафедра ИУ5\\Группа ИУ5-64}

\ESKDsignature{Локальная безадаптерная сеть}
\ESKDtitle{Структура протокольных\\блоков данных}
\ESKDmaterial{\ESKDfontIII Курсовая работа по~курсу\\<<Сетевые технологии в~АСОИУ>>}
\ESKDauthor{Лещев А.О.}
\ESKDcolumnXIfII{\ESKDfontII Мельников К.И.}
\renewcommand{\ESKDcolumnXfIIname}{}
\ESKDapprovedBy{Галкин В.А.}
\ESKDdate{2017/04/25}

\renewcommand{\ESKDcolumnXfIIIname}{}
\renewcommand{\ESKDcolumnXfVname}{}
\ESKDcolumnIX{\ESKDfontIII\ESKDtheDepartment\\\ESKDtheCompany}

\begin{document}
\setlength{\hsize}{\ESKDframeW}
\begin{ESKDdrawing}\hfill
\begin{tikzpicture}[every node/.style={draw,align=center},font=\LARGE,baseline=0em]
\node [draw=none] (namePol) {\Huge Пакеты пользовательского уровня};

\node [below left=0em of namePol,yshift=-3em,anchor=north west,rectangle split,rectangle split horizontal,rectangle split parts=4] (FileName) {\texttt{00000000}\nodepart{two}\texttt{fileDialog.SafeFileName}\nodepart{three}\texttt{fileStream.Length}\nodepart{four}$\mathrm{SHA512}(\mathtt{fileStream})$};
\node [left=1em of FileName,draw=none,text width=22em] (FileNameName) {\huge\texttt{FileName} (пакет данных о~файле)};
\node [anchor=south,draw=none] (FileNameField1) at (FileName.one north) {Тип пакета};
\node [anchor=south,draw=none] (FileNameField2) at (FileName.two north) {Имя файла};
\node [anchor=south,draw=none] (FileNameField3) at (FileName.three north) {Длина файла};
\node [anchor=south,draw=none] (FileNameField4) at (FileName.four north) {Контрольная сумма};
\draw (FileName.north west) -- ($(FileName.south west) + (0,-2.5em)$);
\draw (FileName.one split south) -- ($(FileName.one split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileName.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(FileName.one split south) + (0,-2em)$);
\draw (FileName.two split south) -- ($(FileName.two split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileName.one split south) + (0,-2em)$) -- node [above,draw=none] {$(k + \lfloor\log_{128}k\rfloor + 1)$ байтов} ($(FileName.two split south) + (0,-2em)$);
\draw (FileName.three split south) -- ($(FileName.three split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileName.two split south) + (0,-2em)$) -- node [above,draw=none] {8 байтов} ($(FileName.three split south) + (0,-2em)$);
\draw (FileName.north east) -- ($(FileName.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(FileName.three split south) + (0,-2em)$) -- node [above,draw=none] {64 байта} ($(FileName.south east) + (0,-2em)$);

\node [below left=0em of FileName,yshift=-7em,anchor=north west] (ReceiveNotReady) {\texttt{00000001}};
\node [left=1em of ReceiveNotReady,draw=none,text width=22em] (ReceiveNotReadyName) {\huge\texttt{ReceiveNotReady} (пакет  неготовности к~получению файла)};
\node [anchor=south,draw=none] (ReceiveNotReadyField1) at (ReceiveNotReady.north) {Тип пакета};
\draw (ReceiveNotReady.north west) -- ($(ReceiveNotReady.south west) + (0,-2.5em)$);
\draw (ReceiveNotReady.north east) -- ($(ReceiveNotReady.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(ReceiveNotReady.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(ReceiveNotReady.south east) + (0,-2em)$);

\node [below left=0em of ReceiveNotReady,yshift=-7em,anchor=north west,rectangle split,rectangle split horizontal,rectangle split parts=2] (FileRequest) {\texttt{00000002}\nodepart{two}\texttt{fileStream.Length}};
\node [left=1em of FileRequest,draw=none,text width=22em] (FileRequestName) {\huge\texttt{FileRequest} (пакет запроса части файла)};
\node [anchor=south,draw=none] (FileRequestField1) at (FileRequest.one north) {Тип пакета};
\node [anchor=south,draw=none] (FileRequestField2) at (FileRequest.two north) {Позиция};
\draw (FileRequest.north west) -- ($(FileRequest.south west) + (0,-2.5em)$);
\draw (FileRequest.one split south) -- ($(FileRequest.one split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileRequest.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(FileRequest.one split south) + (0,-2em)$);
\draw (FileRequest.north east) -- ($(FileRequest.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(FileRequest.one split south) + (0,-2em)$) -- node [above,draw=none] {8 байтов} ($(FileRequest.south east) + (0,-2em)$);

\node [below left=0em of FileRequest,yshift=-7em,anchor=north west,rectangle split,rectangle split horizontal,rectangle split parts=4] (FileChunk) {\texttt{00000003}\nodepart{two}Позиция в~файле\nodepart{three}\parbox{5em}{\centering$n$}\nodepart{four}\parbox{7em}{\centering Данные}};
\node [left=1em of FileChunk,draw=none,text width=22em] (FileChunkName) {\huge\texttt{FileChunk}\\(пакет части файла)};
\node [anchor=south,draw=none] (FileChunkField1) at (FileChunk.one north) {Тип пакета};
\node [anchor=south,draw=none] (FileChunkField2) at (FileChunk.two north) {Позиция};
\node [anchor=south,draw=none] (FileChunkField3) at (FileChunk.three north) {Размер части};
\node [anchor=south,draw=none] (FileChunkField4) at (FileChunk.four north) {Часть файла};
\draw (FileChunk.north west) -- ($(FileChunk.south west) + (0,-2.5em)$);
\draw (FileChunk.one split south) -- ($(FileChunk.one split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileChunk.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(FileChunk.one split south) + (0,-2em)$);
\draw (FileChunk.two split south) -- ($(FileChunk.two split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileChunk.one split south) + (0,-2em)$) -- node [above,draw=none] {8 байтов} ($(FileChunk.two split south) + (0,-2em)$);
\draw (FileChunk.three split south) -- ($(FileChunk.three split south) + (0,-2.5em)$);
\draw [latex-latex] ($(FileChunk.two split south) + (0,-2em)$) -- node [above,draw=none] {2 байта} ($(FileChunk.three split south) + (0,-2em)$);
\draw (FileChunk.north east) -- ($(FileChunk.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(FileChunk.three split south) + (0,-2em)$) -- node [above,draw=none] {$n$ байтов} ($(FileChunk.south east) + (0,-2em)$);

\node [below left=0em of FileChunk,yshift=-7em,anchor=north west] (FileReceived) {\texttt{00000004}};
\node [left=1em of FileReceived,draw=none,text width=22em] (FileReceivedName) {\huge\texttt{FileReceived}\\(пакет квитанции о~получении файла)};
\node [anchor=south,draw=none] (FileReceivedField1) at (FileReceived.north) {Тип пакета};
\draw (FileReceived.north west) -- ($(FileReceived.south west) + (0,-2.5em)$);
\draw (FileReceived.north east) -- ($(FileReceived.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(FileReceived.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(FileReceived.south east) + (0,-2em)$);

\node [below left=0em of FileReceived,yshift=-7em,anchor=north west] (FileReceivedOk) {\texttt{00000005}};
\node [left=1em of FileReceivedOk,draw=none,text width=22em] (FileReceivedOkName) {\huge\texttt{FileReceivedOk} (пакет квитанции\\о~завершении передачи)};
\node [anchor=south,draw=none] (FileReceivedOkField1) at (FileReceivedOk.north) {Тип пакета};
\draw (FileReceivedOk.north west) -- ($(FileReceivedOk.south west) + (0,-2.5em)$);
\draw (FileReceivedOk.north east) -- ($(FileReceivedOk.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(FileReceivedOk.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(FileReceivedOk.south east) + (0,-2em)$);

\node [below left=0em of FileReceivedOk,yshift=-7em,anchor=north west] (Disconnect) {\texttt{00000006}};
\node [left=1em of Disconnect,draw=none,text width=22em] (DisconnectName) {\huge\texttt{Disconnect} (пакет разрыва соединения)};
\node [anchor=south,draw=none] (DisconnectField1) at (Disconnect.north) {Тип пакета};
\draw (Disconnect.north west) -- ($(Disconnect.south west) + (0,-2.5em)$);
\draw (Disconnect.north east) -- ($(Disconnect.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(Disconnect.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(Disconnect.south east) + (0,-2em)$);

\node [below left=0em of Disconnect,yshift=-7em,anchor=north west] (DisconnectOk) {\texttt{00000007}};
\node [left=1em of DisconnectOk,draw=none,text width=22em] (DisconnectOkName) {\huge\texttt{DisconnectOk}\\(пакет квитанции о~разрыве соединения)};
\node [anchor=south,draw=none] (DisconnectOkField1) at (DisconnectOk.north) {Тип пакета};
\draw (DisconnectOk.north west) -- ($(DisconnectOk.south west) + (0,-2.5em)$);
\draw (DisconnectOk.north east) -- ($(DisconnectOk.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(DisconnectOk.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(DisconnectOk.south east) + (0,-2em)$);
\end{tikzpicture}\hfill
\begin{tikzpicture}[every node/.style={draw,align=center},font=\LARGE,baseline=0em]
\node [draw=none] (nameKan) {\Huge Кадр канального уровня};

\node [below left=0em of nameKan,yshift=-3em,anchor=north west,rectangle split,rectangle split horizontal,rectangle split parts=4] (Frame) {\parbox{7em}{\centering\texttt{11111111}}\nodepart{two}\parbox{10em}{\centering$\sum_{i=1}^m\mathtt{newPacket}[i]$}\nodepart{three}\texttt{newPacket}\nodepart{four}\parbox{7em}{\centering\texttt{11111111}}};
\node [anchor=south,draw=none] (FrameField1) at (Frame.one north) {Стартовый байт};
\node [anchor=south,draw=none] (FrameField2) at (Frame.two north) {Контрольная сумма};
\node [anchor=south,draw=none] (FrameField3) at (Frame.three north) {Пакет};
\node [anchor=south,draw=none] (FrameField4) at (Frame.four north) {Стоповый байт};
\draw (Frame.north west) -- ($(Frame.south west) + (0,-2.5em)$);
\draw (Frame.one split south) -- ($(Frame.one split south) + (0,-2.5em)$);
\draw [latex-latex] ($(Frame.south west) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(Frame.one split south) + (0,-2em)$);
\draw (Frame.two split south) -- ($(Frame.two split south) + (0,-2.5em)$);
\draw [latex-latex] ($(Frame.one split south) + (0,-2em)$) -- node [above,draw=none] {4 байта} ($(Frame.two split south) + (0,-2em)$);
\draw (Frame.three split south) -- ($(Frame.three split south) + (0,-2.5em)$);
\draw [latex-latex] ($(Frame.two split south) + (0,-2em)$) -- node [above,draw=none] {$m$ байтов} ($(Frame.three split south) + (0,-2em)$);
\draw (Frame.north east) -- ($(Frame.south east) + (0,-2.5em)$);
\draw [latex-latex] ($(Frame.three split south) + (0,-2em)$) -- node [above,draw=none] {1 байт} ($(Frame.south east) + (0,-2em)$);

\node [below left=0em of Frame,yshift=-15em,anchor=north west,draw=none] (nameFiz) {\Huge Блок данных физического уровня};
\node [below left=0em of nameFiz,yshift=-2em,anchor=north west,draw=none] (start) {$\cdots$};
\draw [very thick] ($(start.east) + (0em,0em)$) -- ($(start.east) + (5em,0em)$) -- ($(start.east) + (5em,-3em)$) -- ($(start.east) + (7em,-3em)$) -- ($(start.east) + (7em,0em)$) -- ($(start.east) + (11em,0em)$) -- ($(start.east) + (11em,-3em)$) -- ($(start.east) + (17em,-3em)$) -- ($(start.east) + (17em,0em)$) -- ($(start.east) + (19em,0em)$) -- ($(start.east) + (19em,-3em)$) -- ($(start.east) + (23em,-3em)$) -- ($(start.east) + (23em,0em)$) -- ($(start.east) + (30em,0em)$);
\node [right=0em of start,xshift=30em,draw=none] (stop) {$\cdots$};
\draw [thin] ($(start.east) + (5em,0em)$) -- ($(start.east) + (5em,-6em)$);
\draw [thin] ($(start.east) + (7em,0em)$) -- ($(start.east) + (7em,-6em)$);
\draw [latex-latex] ($(start.east) + (5em,-5.5em)$) -- node [draw=none,anchor=west,rotate=-90] {Стартовый бит} ($(start.east) + (7em,-5.5em)$);
\draw [thin] ($(start.east) + (23em,0em)$) -- ($(start.east) + (23em,-6em)$);
\draw [latex-latex] ($(start.east) + (7em,-5.5em)$) -- node [draw=none,above] {8~бит данных} ($(start.east) + (23em,-5.5em)$);
\draw [thin] ($(start.east) + (25em,0em)$) -- ($(start.east) + (25em,-6em)$);
\draw [latex-latex] ($(start.east) + (23em,-5.5em)$) -- node [draw=none,anchor=west,rotate=-90] {Стоповый бит} ($(start.east) + (25em,-5.5em)$);
\end{tikzpicture}\hfill\phantom{}
\end{ESKDdrawing}
\end{document}