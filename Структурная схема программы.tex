\documentclass[russian,utf8,a2paper,simple,nocolumnxxvi,vpadding=0mm]{eskdgraph}
\usepackage{cmap}
\usepackage{tikz}
\usetikzlibrary{calc,positioning}

\newcommand{\No}{\textnumero}

\ESKDdepartment{МГТУ им. Н.Э.\,Баумана}
\ESKDcompany{Кафедра ИУ5\\Группа ИУ5-64}

\ESKDsignature{Локальная безадаптерная сеть}
\ESKDtitle{Структурная схема программы}
\ESKDmaterial{\ESKDfontIII Курсовая работа по~курсу\\<<Сетевые технологии в~АСОИУ>>}
\ESKDauthor{Лещев А.О.}
\ESKDcolumnXIfII{\ESKDfontII Мельников К.И.}
\renewcommand{\ESKDcolumnXfIIname}{}
\ESKDapprovedBy{Галкин В.А.}
\ESKDdate{2017/04/25}

\renewcommand{\ESKDcolumnXfIIIname}{}
\renewcommand{\ESKDcolumnXfVname}{}
\ESKDcolumnIX{\ESKDfontIII\ESKDtheDepartment\\\ESKDtheCompany}

\begin{document}
\setlength{\hsize}{\ESKDframeW}
\begin{ESKDdrawing}
\begin{tikzpicture}[every node/.style={draw,align=center},-latex,font=\LARGE,baseline=0em]
\node [very thick,text width=76em] (user) {\Huge Пользователь};
\node [very thick,dashed,text width=76em,text height=18em,below=of user] (pol) {};
\node [draw=none,right=of pol] {\Huge Пользовательский уровень};
\node [text width=72em,yshift=-2em,anchor=north] (ui) at (pol.north) {Пользовательский интерфейс};
\draw ($(user.south)+(-5em,0)$) -- ($(ui.north)+(-5em,0)$);
\draw ($(ui.north)+(5em,0)$) -- ($(user.south)+(5em,0)$);
\node [anchor=north west,yshift=-2em,text width=10em] (mes) at (ui.south west) {Отображение сообщения};
\draw (mes) -- ($(ui.south west)!(mes)!(ui.south)$);
\node [below=2em of mes,text width=10em] (proc) {Обработка пакета};
\draw (proc) -- (mes);
\node [right=2em of mes,text width=15em] (send) {Кнопка\\<<Отправить файл>>};
\draw ($(ui.south west)!(send)!(ui.south)$) -- (send);
\node [below=2em of send,text width=10em] (pac) {Отправка пакета};
\draw (proc) -- ($(pac.north west)!(proc)!(pac.west)$);
\draw (send) -- (pac);
\node [anchor=north west,xshift=2em,text width=10em] (cont) at (send.north east) {Индикатор контактов COM-порта};
\draw (cont) -- ($(ui.south west)!(cont)!(ui.south)$);
\node [anchor=north west,xshift=2em,text width=13em] (openb) at (cont.north east) {Кнопка\\<<Открыть порт>>};
\draw ($(ui.south west)!(openb)!(ui.south)$) -- (openb);
\node [right=2em of openb,text width=13em] (closeb) {Кнопка\\<<Закрыть порт>>};
\draw ($(ui.south west)!(closeb)!(ui.south)$) -- (closeb);

\node [very thick,dashed,text width=76em,text height=16em,below=of pol] (kan) {};
\node [draw=none,right=of kan] {\Huge Канальный уровень};
\node [anchor=north west,xshift=2em,yshift=-2em,text width=10em] (checksum) at (kan.north west) {Проверка контрольной суммы};
\draw (checksum) -- ($(proc.south west)!(checksum)!(proc.south)$);
\node [below=2em of checksum,text width=10em] (getframe) {Сборка кадра};
\draw (getframe) -- (checksum);
\node [right=3em of checksum,text width=10em] (getsum) {Расчёт контрольной суммы};
\draw ($(pac.south west)!(getsum)!(pac.south)$) -- (getsum);
\node [below=2em of getsum,text width=12em] (frame) {Формирование кадра};
\draw (getsum) -- (frame);

\node [very thick,dashed,text width=76em,text height=26em,below=of kan] (phy) {};
\node [draw=none,right=of phy] {\Huge Физический уровень};
\node [very thick,text width=76em,below=of phy] (ao) {\Huge Аппаратное обеспечение};
\node [anchor=north west,xshift=2em,yshift=-2em,text width=12em] (dec) at (phy.north west) {Декодирование циклического кода $[15,11]$};
\draw ($(dec.north west)!(getframe)!(dec.north)$) -- (getframe);
\node [below=2em of dec,text width=12em] (getbytes) {Приём группы по~2~байта};
\draw (getbytes) -- (dec);
\draw ($(ao.north west)!(getbytes)!(ao.north)$) -- (getbytes);
\node [right=2em of dec,text width=13em] (spl) {Разбиение кадра\\на~группы по~11~бит};
\draw (frame) -- ($(spl.north west)!(frame)!(spl.north)$);
\node [below=2em of spl,text width=10em] (cod) {Кодирование циклическим кодом $[15,11]$};
\draw (spl) -- (cod);
\node [below=2em of cod,text width=8em] (byte) {Отправка байтов};
\draw (cod) -- (byte);
\draw (byte) -- ($(ao.north west)!(byte)!(ao.north)$);
\node [right=6em of byte,text width=10em] (change) {Изменение состояния COM-порта};
\coordinate [above=2em of change] (changeb);
\draw (change) -- (changeb);
\draw (byte) -| ($(change.north west)+(-2em,0)$) |- node [pos=1,anchor=south east,draw=none] {\large Порт недоступен} (changeb);
\draw (changeb) -- ($(cont.south west)!(changeb)!(cont.south)$);
\node [right=2em of change,text width=10em] (open) {Открытие COM-порта};
\node [above=2em of open,text width=10em] (set) {Настройка COM-порта};
\draw (openb) -- ($(set.north west)!(openb)!(set.north)$);
\draw (set) -- (open);
\draw (open) -- ($(ao.north west)!(open)!(ao.north)$);
\node [right=5em of open,text width=10em] (close) {Закрытие COM-порта};
\draw (closeb) -- ($(close.north west)!(closeb)!(close.north)$);
\draw (close) -- ($(ao.north west)!(close)!(ao.north)$);
\end{tikzpicture}
\end{ESKDdrawing}
\end{document}